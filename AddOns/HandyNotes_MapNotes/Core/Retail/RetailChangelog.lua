local ADDON_NAME, ns = ...
local L = LibStub("AceLocale-3.0"):GetLocale(ADDON_NAME)
ns.PreviousAddonVersion = "3.0.5"
ns.CurrentAddonVersion = "3.0.6"

ns.LOCALE_CHANGELOG_NEW = {
  deDE = [[
• Die Link funktion im Chat-Optionen Reiter wurde angepasst, damit diese nun auch 
korrekt im Gruppenchat und Gildenchat funktioniert.

• Die Anzeige für Quest, Erfolgs und sonstinte Bedingungen für Portale wurde überarbeitet
sowie die dazugehörige Linkausgabe im Chat.

• Die NPC-Namensdatenbank speichert die Daten nun dauerhaft in den MapNotes SavedVariables 
bei einer neuen Version für die jeweilige Sprache und stellt so sicher, 
dass die Datenbank auch für neu erstellte Charaktere verfügbar und aktuell ist.

• Der Unterreiter „Ordenshallensymbole“ wurde dem Reiter „Hauptstädte +“ hinzugefügt. 
Damit sollte die Ordenshalle bis zum „Legion Remix“ für alle Klassen mit entsprechenden Symbolen vollständig sein.
Die Eingänge zur Ordenshalle befinden sich auf den Verheerten Inseln, beispielsweise in Dalaran, Val'Sharah, dem Hochberg und Sturmheim.
Weitere Ordenshallen für die fehlenden Klassen werden in nächster Zeit hinzugefügt.

• Es wurden auch noch ein paar Änderung für Classic + bzw Pandaria Classic vorgenommen
]],

  enUS = [[
• The link function in the Chat Options tab has been adjusted so that it now 
works correctly in group chat and guild chat.

• The display for quest, achievement and other requirements for portals has been revised, 
as well as the related link output in chat.

• The NPC name database now permanently stores data in the MapNotes SavedVariables 
for each language when a new version is released, ensuring that the database 
is also available and up to date for newly created characters.

• The sub-tab "Order Hall Symbols" has been added to the "Capitals +" tab. 
This should make the Order Halls complete up to the "Legion Remix" for all classes with the corresponding icons.
The entrances to the Order Halls can be found on the Broken Isles, for example in Dalaran, Val'Sharah, Highmountain and Stormheim.
More Order Halls for the missing classes will be added in the near future.

• A few additional changes were also made for Classic+ and Pandaria Classic
]],

  frFR = [[
• La fonction de lien dans l’onglet Options de discussion a été ajustée afin qu’elle 
fonctionne désormais correctement dans le chat de groupe et le chat de guilde.

• L’affichage des conditions de quêtes, hauts faits et autres exigences pour les portails a été révisé, 
ainsi que la sortie de lien correspondante dans le chat.

• La base de données des noms de PNJ enregistre désormais les données de façon permanente 
dans les SavedVariables de MapNotes pour chaque langue lors d’une nouvelle version, 
garantissant ainsi que la base de données soit disponible et à jour pour les personnages nouvellement créés.

• L’onglet secondaire « Symboles du domaine de classe » a été ajouté à l’onglet « Capitales + ». 
Cela devrait rendre les domaines de classe complets jusqu’au « Remix de Legion » pour toutes les classes avec les icônes correspondantes.
Les entrées des domaines de classe se trouvent sur les Îles Brisées, par exemple à Dalaran, Val'Sharah, Haut-Roc et Tornheim.
D’autres domaines de classe pour les classes manquantes seront ajoutés prochainement.

• Quelques modifications supplémentaires ont également été apportées pour Classic+ et Pandaria Classic
]],

  itIT = [[
• La funzione link nella scheda Opzioni della chat è stata regolata in modo che ora 
funzioni correttamente nella chat di gruppo e di gilda.

• La visualizzazione dei requisiti di missioni, imprese e altre condizioni per i portali è stata rivista, 
così come l’output del collegamento in chat.

• Il database dei nomi degli NPC ora salva permanentemente i dati nelle SavedVariables di MapNotes 
per ciascuna lingua con una nuova versione, garantendo che il database 
sia disponibile e aggiornato anche per i personaggi appena creati.

• La sotto-scheda "Simboli del Rifugio di Classe" è stata aggiunta alla scheda "Capitali +". 
Questo dovrebbe rendere i Rifugi di Classe completi fino al "Legion Remix" per tutte le classi con le relative icone.
Gli ingressi ai Rifugi di Classe si trovano nelle Isole Disperse, ad esempio a Dalaran, Val'Sharah, Alto Monte e Stromheim.
Altri Rifugi di Classe per le classi mancanti verranno aggiunti prossimamente.

• Sono state apportate anche alcune modifiche aggiuntive a Classic+ e a Pandaria Classic
]],

  esES = [[
• La función de enlace en la pestaña de Opciones de chat se ha ajustado para que ahora 
funcione correctamente en el chat de grupo y en el chat de hermandad.

• Se ha revisado la visualización de los requisitos de misiones, logros y otras condiciones para los portales, 
así como la salida del enlace correspondiente en el chat.

• La base de datos de nombres de PNJ ahora guarda los datos de forma permanente en las SavedVariables de MapNotes 
para cada idioma en cada nueva versión, asegurando que la base de datos 
esté disponible y actualizada también para los personajes recién creados.

• Se ha añadido la subpestaña «Símbolos de la Sede de Clase» a la pestaña «Capitales +». 
Esto debería completar las Sedes de Clase hasta el «Legion Remix» para todas las clases con los iconos correspondientes.
Las entradas a las Sedes de Clase se encuentran en las Islas Quebradas, por ejemplo en Dalaran, Val'Sharah, Monte Alto y Tormenheim.
Próximamente se añadirán más Sedes de Clase para las clases que faltan.

• También se han realizado algunos cambios adicionales para Classic+ y Pandaria Classic
]],

  esMX = [[
• La función de enlace en la pestaña de Opciones de chat se ha ajustado para que ahora 
funcione correctamente en el chat de grupo y en el chat de hermandad.

• Se revisó la visualización de los requisitos de misiones, logros y otras condiciones para los portales, 
así como la salida del enlace correspondiente en el chat.

• La base de datos de nombres de PNJ ahora guarda permanentemente los datos en las SavedVariables de MapNotes 
para cada idioma con cada nueva versión, asegurando que la base de datos 
también esté disponible y actualizada para los personajes recién creados.

• Se agregó la subpestaña «Símbolos de la Sede de Clase» a la pestaña «Capitales +». 
Esto debería completar las Sedes de Clase hasta el «Legion Remix» para todas las clases con los iconos correspondientes.
Las entradas a las Sedes de Clase se encuentran en las Islas Quebradas, por ejemplo en Dalaran, Val'Sharah, Monte Alto y Tormenheim.
Próximamente se añadirán más Sedes de Clase para las clases faltantes.

• También se hicieron algunos cambios adicionales para Classic+ y Pandaria Classic
]],

  ruRU = [[
• Функция ссылок на вкладке параметров чата была доработана, 
чтобы теперь она корректно работала в групповом и гильдейском чате.

• Отображение требований для заданий, достижений и других условий для порталов было переработано, 
а также обновлён вывод ссылок в чате.

• База данных имён NPC теперь постоянно сохраняет данные в SavedVariables MapNotes 
для каждого языка при выходе новой версии, гарантируя, что база данных 
доступна и актуальна также для вновь созданных персонажей.

• Подвкладка «Символы оплота класса» была добавлена во вкладку «Столицы +». 
Это должно сделать оплоты классов полными до «Legion Remix» для всех классов с соответствующими значками.
Входы в оплоты классов находятся на Расколотых островах, например в Даларане, Валь'Шаре, Крутогорье и Штормхейме.
В ближайшее время будут добавлены и другие оплоты для недостающих классов.

• Также были внесены некоторые дополнительные изменения для Classic+ и Pandaria Classic
]],

  ptBR = [[
• A função de link na guia Opções de Chat foi ajustada para que agora 
funcione corretamente no bate-papo de grupo e de guilda.

• A exibição dos requisitos de missões, conquistas e outras condições para portais foi revisada, 
assim como a saída de link correspondente no chat.

• O banco de dados de nomes de NPC agora armazena permanentemente os dados nas SavedVariables do MapNotes 
para cada idioma em cada nova versão, garantindo que o banco de dados 
também esteja disponível e atualizado para personagens recém-criados.

• A subguia "Símbolos do Salão de Classe" foi adicionada à guia "Capitais +". 
Isso deve tornar os Salões de Classe completos até o "Legion Remix" para todas as classes com os ícones correspondentes.
As entradas para os Salões de Classe ficam nas Ilhas Partidas, por exemplo em Dalaran, Val'Sharah, Alta Montanha e Tromheim.
Mais Salões de Classe para as classes que faltam serão adicionados em breve.

• Também foram feitas algumas mudanças adicionais para Classic+ e Pandaria Classic
]],

  zhCN = [[
• 聊天选项标签中的链接功能已调整，现在可在小队聊天和公会聊天中正常工作。

• 任务、成就及其他传送门需求的显示已重新设计，聊天中的相关链接输出也已更新。

• NPC 名称数据库现在会在新版本发布时将数据永久存储到 MapNotes 的 SavedVariables 中，
并按语言区分，确保数据库在新建角色时也可用且保持最新。

• 在“主城 +”标签页中新增了“职业大厅符号”子标签。 
这将使职业大厅在“军团再临混合版”之前对所有职业及其图标完整开放。
职业大厅入口位于破碎群岛，例如达拉然、瓦尔莎拉、高山和斯托姆海姆。
缺失职业的大厅将在近期陆续加入。

• 还对 Classic+ 和 熊猫人经典版 进行了部分改动
]],

  zhTW = [[
• 聊天選項分頁中的連結功能已調整，現在能在隊伍聊天與公會聊天中正常運作。

• 任務、成就及其他傳送門需求的顯示已重新設計，聊天中的相關連結輸出也已更新。

• NPC 名稱資料庫現在會在新版本時依語言永久儲存至 MapNotes 的 SavedVariables，
確保資料庫在新建立的角色中也能使用並保持最新。

• 在「主城 +」分頁中新增了「職業大廳符號」子分頁。 
這將使職業大廳在「軍團再臨 Remix」之前對所有職業及其圖示完整提供。
職業大廳入口位於破碎群島，例如達拉然、瓦爾莎拉、高嶺與斯托姆海姆。
缺少的職業大廳將於近期陸續新增。

• 同時也對 Classic+ 與 熊貓人經典版 進行了一些額外調整
]],
}

ns.LOCALE_CHANGELOG_OLD = {
  deDE = [[
• In „Hauptstädte +“ - „Transport“ Reiter wurden Kampfhaustier Portalsymbole 
zu der „Portal“ Kategorie hinzugefügt.

• Im „Zonen +“ - „Instanz Symbole“ wurde Haustierkampf Dungeonsymbole hinzugefügt.

• Es wurden Kampfhaustierdungeons in den jeweiligen Zonen hinzugefügt.

• Es wurden Portalsymbole in „Dazar'Alor“, „Boralus“ und „Legion Dalaran“
zu den Kampfhaustierdungeons hinzugefügt.
Zusätzlich wurde eine Anzeige hinzugefügt, die zeigt, ob ihr den jeweiligen
Quest schon abgeschlossen habt, passend zu dem Portal.

• Wenn ihr die „Link“ Funktion im Addon-Menü aktiviert habt, könnt ihr euch den
jeweiligen Quest-Link im Chat anzeigen lassen und mit dem „Link“ dann rauskopieren,
wenn ihr auf diesen Link im Chat klickt.
Es wird immer nur der Quest mit dem Questnamen im Chat ausgegeben, 
wenn dieser auch wirklich fehlt.

• Allgemeine Tooltip-Anzeigen wurden überarbeitet.
Aktivierbar innerhalb des „Allgemein“ - „Erweiterte Optionen“ Reiters unter „Tooltip“.

• Sollte es mal vorkommen, dass bei manchen Spielern nicht alle NPC-Namen angezeigt werden, 
können diese manuell mit der Funktion „NPC-Namen aktualisieren“ im „Allgemein“ - „NPC-Datenbank“ 
Reiter aktualisiert werden.
]],

  enUS = [[
• Added pet battle portal icons to the “Portal” category under the “Capitals +” → “Transport” tab.

• Added pet battle dungeon icons to the “Zones +” → “Instance Symbols” section.

• Pet Battle Dungeons have been added in their respective zones.

• Portal icons were added for Pet Battle Dungeons in Dazar’Alor, Boralus, and Legion Dalaran.
A new indicator has also been added to show if you have already completed the corresponding
quest for the respective portal.

• If the “Link” function is enabled in the addon menu, clicking the “Link” will show the
quest link in chat, which you can then copy. Only missing quests will be shown by name.

• General tooltip displays have been overhauled.
You can toggle them under “General” → “Advanced Options” → “Tooltip.”

• If some NPC names are not displaying for certain players, they can be manually updated using
the “Update NPC Names” function under “General” → “NPC Database.”
]],

  frFR = [[
• Des icônes de portails de combats de mascottes ont été ajoutées à la catégorie « Portail »
sous l’onglet « Capitales + » → « Transport ».

• Des icônes de donjons de combats de mascottes ont été ajoutées à la section « Zones + »
→ « Symboles d’instance ».

• Des donjons de combats de mascottes ont été ajoutés dans leurs zones respectives.

• Des icônes de portails ont été ajoutées pour les donjons de combats de mascottes à
Dazar’Alor, Boralus et Legion Dalaran.
Un nouvel indicateur a également été ajouté pour afficher si vous avez déjà terminé la quête
correspondante au portail.

• Si la fonction « Lien » est activée dans le menu de l’addon, cliquer sur « Lien » affichera
le lien de quête dans le chat, que vous pourrez copier. Seules les quêtes manquantes seront
affichées par nom.

• L’affichage des info-bulles générales a été retravaillé.
Vous pouvez l’activer sous « Général » → « Options avancées » → « Info-bulle ».

• Si certains noms de PNJ n’apparaissent pas pour certains joueurs, ils peuvent être mis à jour
manuellement avec la fonction « Mettre à jour les noms des PNJ » dans « Général »
→ « Base de données PNJ ».
]],

  itIT = [[
• Aggiunte icone dei portali dei combattimenti tra mascotte nella categoria “Portale”
nella scheda “Capitali +” → “Trasporti”.

• Aggiunte icone dei dungeon dei combattimenti tra mascotte nella sezione “Zone +”
→ “Simboli Istanze”.

• Aggiunti dungeon di combattimento tra mascotte nelle relative zone.

• Aggiunte icone dei portali per i dungeon di combattimento tra mascotte a
Dazar’Alor, Boralus e Legion Dalaran.
È stato inoltre aggiunto un indicatore per mostrare se hai già completato la missione
correlata al portale.

• Se la funzione “Link” è attivata nel menu dell’addon, fare clic su “Link” mostrerà il
collegamento della missione nella chat, che potrai copiare. Verranno mostrati solo i nomi
delle missioni mancanti.

• Le visualizzazioni generali dei tooltip sono state riviste.
Puoi attivarle in “Generale” → “Opzioni avanzate” → “Tooltip”.

• Se i nomi di alcuni PNG non vengono visualizzati per alcuni giocatori, possono essere
aggiornati manualmente con la funzione “Aggiorna nomi PNG” in “Generale”
→ “Database PNG”.
]],

  esES = [[
• Se han añadido iconos de portales de combates de mascotas a la categoría “Portal”
en la pestaña “Capitales +” → “Transporte”.

• Se han añadido iconos de mazmorras de combates de mascotas en la sección “Zonas +”
→ “Símbolos de instancia”.

• Se han añadido mazmorras de combates de mascotas en sus respectivas zonas.

• Se añadieron iconos de portales para mazmorras de combates de mascotas en
Dazar’Alor, Boralus y Legión Dalaran.
También se ha añadido un indicador para mostrar si ya completaste la misión
correspondiente al portal.

• Si la función “Link” está activa en el menú del addon, al hacer clic en “Link”
se mostrará el enlace de la misión en el chat, que podrás copiar. Solo se mostrarán
las misiones que te falten.

• Se ha rehecho la visualización general de tooltips.
Puedes activarla en “General” → “Opciones avanzadas” → “Tooltip”.

• Si a algunos jugadores no se les muestran todos los nombres de PNJ, pueden
actualizarlos manualmente usando la función “Actualizar nombres de PNJ” en
“General” → “Base de datos de PNJ”.
]],

  esMX = [[
• Se agregaron íconos de portales de combates de mascotas a la categoría “Portal”
en la pestaña “Capitales +” → “Transporte”.

• Se agregaron íconos de mazmorras de combates de mascotas en la sección “Zonas +”
→ “Símbolos de instancia”.

• Se agregaron mazmorras de combates de mascotas en sus zonas respectivas.

• Se agregaron íconos de portales para mazmorras de combates de mascotas en
Dazar’Alor, Boralus y Legión Dalaran.
También se añadió un indicador que muestra si ya completaste la misión
correspondiente al portal.

• Si la función “Link” está habilitada en el menú del addon, al hacer clic en “Link”
se mostrará el enlace de la misión en el chat, que puedes copiar. Solo se mostrarán
las misiones faltantes.

• Se revisó la visualización general de tooltips.
Puedes activarla en “General” → “Opciones avanzadas” → “Tooltip”.

• Si ciertos jugadores no ven todos los nombres de PNJ, pueden actualizar
manual-mente usando la función “Actualizar nombres de PNJ” en
“General” → “Base de datos de PNJ”.
]],

  ruRU = [[
• В разделе «Столицы +» → «Транспорт» были добавлены значки порталов для
бегемот-боев (питомцев).

• В разделе «Зоны +» → «Символы подземелий» были добавлены значки питомец-боев.

• Питомец-подземелья были добавлены в соответствующих зонах.

• Были добавлены значки порталов для питомец-подземелий в Dazar’Alor, Boralus и
Legion Dalaran.
Также добавлен индикатор, который показывает, завершена ли соответствующая
задача к порталу.

• Если в меню аддона включена функция «Ссылка», при клике по «Ссылке» в чат
выводится ссылка на квест, которую можно скопировать. Отображаются только
отсутствующие квесты.

• Общие отображения всплывающих подсказок были переработаны.
Вы можете включить их в разделе «Общее» → «Расширенные параметры» → «Подсказка».

• Если у некоторых игроков не отображаются имена NPC, их можно вручную
обновить через функцию «Обновить имена NPC» в разделе «Общее»
→ «База данных NPC».
]],

  ptBR = [[
• Foram adicionados ícones de portais de batalhas de mascotes à categoria “Portal”
na aba “Capitais +” → “Transporte”.

• Foram adicionados ícones de masmorras de batalhas de mascotes na seção “Zonas +”
→ “Símbolos de Instância”.

• Masmorras de batalha de mascotes foram adicionadas em suas zonas correspondentes.

• Foram adicionados ícones de portais para masmorras de batalha de mascotes em
Dazar’Alor, Boralus e Legião Dalaran.
Também foi adicionado um indicador que mostra se você já completou a missão
correspondente ao portal.

• Se a função “Link” estiver ativada no menu do addon, ao clicar em “Link”
o link da missão será exibido no chat, e você poderá copiá-lo. Apenas missões
faltando serão mostradas.

• As exibições gerais das tooltips foram revisadas.
Você pode ativá-las em “Geral” → “Opções Avançadas” → “Tooltip”.

• Se nomes de alguns NPCs não estiverem aparecendo para certos jogadores,
eles podem ser atualizados manualmente com a função “Atualizar nomes de NPC”
em “Geral” → “Banco de Dados de NPC”.
]],

  zhCN = [[
• 在“首都 +” → “传送”标签下的“传送门”分类中，添加了战斗小宠物传送门图标。

• 在“区域 +” → “副本图标”部分，添加了战斗小宠物副本图标。

• 已在各自区域中添加了战斗小宠物副本。

• 在达萨罗、伯拉勒斯和军团达拉然的小宠物副本中添加了传送门图标。
同时新增了一个指示器，用于显示你是否已完成该传送门对应的任务。

• 如果在插件菜单中启用了“链接”功能，点击“链接”将在聊天中显示任务链接，供你复制。
只有缺少的任务才会以任务名称形式显示。

• 通用鼠标提示显示已重新设计，可在“常规” → “高级选项” → “Tooltip”中启用。

• 如果部分玩家看不到所有 NPC 名称，可以通过“常规” → “NPC 数据库”中的“更新 NPC 名称”功能手动更新。
]],

  zhTW = [[
• 在「首都 +」→「傳送」標籤下的「傳送門」分類中，新增了戰寵戰鬥的傳送門圖示。

• 在「區域 +」→「副本圖示」部分，新增了戰寵戰鬥副本圖示。

• 各區域已新增戰寵戰鬥副本。

• 在達薩羅、伯拉勒斯與軍團達拉然的戰寵戰鬥副本添加了傳送門圖示。
並新增一個指示器，顯示你是否已完成與該傳送門關聯的任務。

• 若在插件選單啟用了「連結」功能，點擊「連結」會在聊天中顯示該任務的連結，可供複製。
只有缺少的任務才會顯示任務名稱。

• 通用提示工具已重新設計，可在「一般」→「進階選項」→「Tooltip」中啟用。

• 若某些玩家無法看到所有 NPC 名稱，可透過「一般」→「NPC 資料庫」中的「更新 NPC 名稱」功能進行手動更新。
]],
}

function ns.ShowChangelogWindow()
  if MapNotesChangelogFrame and MapNotesChangelogFrame:IsShown() or MapNotesChangelogFrameMenu and MapNotesChangelogFrameMenu:IsShown() then return end

  C_Timer.After(0.01, function()
    local LoginChangeLogFrame = CreateFrame("Frame", "MapNotesChangelogFrame", UIParent, "BasicFrameTemplateWithInset")
    LoginChangeLogFrame:SetSize(750, 400)
    LoginChangeLogFrame:SetPoint("CENTER")
    LoginChangeLogFrame:SetMovable(true)
    LoginChangeLogFrame:EnableMouse(true)
    LoginChangeLogFrame:RegisterForDrag("LeftButton")
    LoginChangeLogFrame:SetScript("OnDragStart", LoginChangeLogFrame.StartMoving)
    LoginChangeLogFrame:SetScript("OnDragStop", LoginChangeLogFrame.StopMovingOrSizing)
    LoginChangeLogFrame:SetFrameStrata("DIALOG")
    LoginChangeLogFrame:SetToplevel(true)
    LoginChangeLogFrame:SetClampedToScreen(true)

    LoginChangeLogFrame.title = LoginChangeLogFrame:CreateFontString(nil, "OVERLAY", "GameFontHighlightLarge")
    LoginChangeLogFrame.title:SetPoint("TOP", 0, -3)
    LoginChangeLogFrame.title:SetText(ns.COLORED_ADDON_NAME .. "|cffffd700 " .. L["Changelog"])

    LoginChangeLogFrame.fixedVersionText = LoginChangeLogFrame:CreateFontString(nil, "OVERLAY", "GameFontHighlight")
    LoginChangeLogFrame.fixedVersionText:SetPoint("TOPLEFT", 10, -5)
    LoginChangeLogFrame.fixedVersionText:SetText("|cffffd700" .. GAME_VERSION_LABEL .. ":|r " .. "|cffff0000" .. ns.CurrentAddonVersion)
        
    LoginChangeLogFrame.scrollFrame = CreateFrame("ScrollFrame", nil, LoginChangeLogFrame, "UIPanelScrollFrameTemplate")
    LoginChangeLogFrame.scrollFrame:SetPoint("TOPLEFT", 10, -40)
    LoginChangeLogFrame.scrollFrame:SetPoint("BOTTOMRIGHT", -30, 50)

    local content = CreateFrame("Frame", nil, LoginChangeLogFrame.scrollFrame) -- EditBox with padding inside frame
    content:SetSize(700, 1)

    LoginChangeLogFrame.editBox = CreateFrame("EditBox", nil, content)
    LoginChangeLogFrame.editBox:SetMultiLine(true)
    LoginChangeLogFrame.editBox:SetFontObject(GameFontHighlight)

    local padding = 38 -- = 1cm left and right
    LoginChangeLogFrame.editBox:SetWidth(700 - (padding * 2))
    LoginChangeLogFrame.editBox:SetPoint("TOPLEFT", padding, 0)
    LoginChangeLogFrame.editBox:SetPoint("RIGHT", content, "RIGHT", -padding, 0)
    LoginChangeLogFrame.editBox:SetAutoFocus(false)

    local changelogText = ns.LOCALE_CHANGELOG_NEW[GetLocale()] or ns.LOCALE_CHANGELOG_NEW["enUS"]
    LoginChangeLogFrame.editBox:SetText("|cffffd700" .. changelogText)
    LoginChangeLogFrame.scrollFrame:SetScrollChild(content)
    LoginChangeLogFrame.checkbox = CreateFrame("CheckButton", nil, LoginChangeLogFrame, "ChatConfigCheckButtonTemplate")
    LoginChangeLogFrame.checkbox:SetPoint("BOTTOMLEFT", 10, 10)
    LoginChangeLogFrame.checkbox.Text:SetText("|cffff0000" .. L["Do not show again until next version"])
    LoginChangeLogFrame.closeButton = CreateFrame("Button", nil, LoginChangeLogFrame, "GameMenuButtonTemplate")
    LoginChangeLogFrame.closeButton:SetPoint("BOTTOMRIGHT", -10, -10)
    LoginChangeLogFrame.closeButton:SetSize(100, 25)
    LoginChangeLogFrame.closeButton:SetText(CLOSE)

    LoginChangeLogFrame.closeButton:SetScript("OnClick", function()
      if LoginChangeLogFrame.checkbox:GetChecked() then
        HandyNotes_MapNotesRetailChangelogDB.lastChangelogVersion = ns.CurrentAddonVersion
      end
      LoginChangeLogFrame:Hide()
    end)

    LoginChangeLogFrame:SetScript("OnHide", function()
      if LoginChangeLogFrame.checkbox:GetChecked() then
        HandyNotes_MapNotesRetailChangelogDB.lastChangelogVersion = ns.CurrentAddonVersion
      end
    end)

  end)

  table.insert(UISpecialFrames, "MapNotesChangelogFrame")
end

function ns.ShowChangelogWindowMenuNew()
  if (MapNotesChangelogFrame and MapNotesChangelogFrame:IsShown()) or (MapNotesChangelogFrameMenu and MapNotesChangelogFrameMenu:IsShown()) then return end

  local ChangeLogFrameMenu = CreateFrame("Frame", "MapNotesChangelogFrameMenu", UIParent, "BasicFrameTemplateWithInset")
  ChangeLogFrameMenu:SetSize(750, 400)
  ChangeLogFrameMenu:SetPoint("CENTER")
  ChangeLogFrameMenu:SetMovable(true)
  ChangeLogFrameMenu:EnableMouse(true)
  ChangeLogFrameMenu:RegisterForDrag("LeftButton")
  ChangeLogFrameMenu:SetScript("OnDragStart", ChangeLogFrameMenu.StartMoving)
  ChangeLogFrameMenu:SetScript("OnDragStop", ChangeLogFrameMenu.StopMovingOrSizing)
  ChangeLogFrameMenu:SetFrameStrata("DIALOG")
  ChangeLogFrameMenu:SetToplevel(true)
  ChangeLogFrameMenu:SetClampedToScreen(true)

  ChangeLogFrameMenu.title = ChangeLogFrameMenu:CreateFontString(nil, "OVERLAY", "GameFontHighlightLarge")
  ChangeLogFrameMenu.title:SetPoint("TOP", 0, -3)
  ChangeLogFrameMenu.title:SetText(ns.COLORED_ADDON_NAME .. "|cffffd700 " .. L["Changelog"])

  ChangeLogFrameMenu.fixedVersionText = ChangeLogFrameMenu:CreateFontString(nil, "OVERLAY", "GameFontHighlight")
  ChangeLogFrameMenu.fixedVersionText:SetPoint("TOPLEFT", 10, -5)
  ChangeLogFrameMenu.fixedVersionText:SetText("|cffffd700" .. GAME_VERSION_LABEL .. ":|r " .. "|cffff0000" .. ns.CurrentAddonVersion)

  ChangeLogFrameMenu.scrollFrame = CreateFrame("ScrollFrame", nil, ChangeLogFrameMenu, "UIPanelScrollFrameTemplate")
  ChangeLogFrameMenu.scrollFrame:SetPoint("TOPLEFT", 10, -40)
  ChangeLogFrameMenu.scrollFrame:SetPoint("BOTTOMRIGHT", -30, 50)

  local content = CreateFrame("Frame", nil, ChangeLogFrameMenu.scrollFrame) -- EditBox with padding inside frame
  content:SetSize(700, 1)
  ChangeLogFrameMenu.editBox = CreateFrame("EditBox", nil, content)
  ChangeLogFrameMenu.editBox:SetMultiLine(true)
  ChangeLogFrameMenu.editBox:SetFontObject(GameFontHighlight)

  local padding = 38 -- = 1cm left and right
  ChangeLogFrameMenu.editBox:SetWidth(700 - padding * 2)
  ChangeLogFrameMenu.editBox:SetPoint("TOPLEFT", padding, 0)
  ChangeLogFrameMenu.editBox:SetPoint("RIGHT", content, "RIGHT", -padding, 0)
  ChangeLogFrameMenu.editBox:SetAutoFocus(false)

  local changelogText = ns.LOCALE_CHANGELOG_NEW[GetLocale()] or ns.LOCALE_CHANGELOG_NEW["enUS"]
  ChangeLogFrameMenu.editBox:SetText("|cffffd700" .. changelogText)
  ChangeLogFrameMenu.scrollFrame:SetScrollChild(content)

  ChangeLogFrameMenu.closeButton = CreateFrame("Button", nil, ChangeLogFrameMenu, "GameMenuButtonTemplate")
  ChangeLogFrameMenu.closeButton:SetPoint("BOTTOMRIGHT", -10, -10)
  ChangeLogFrameMenu.closeButton:SetSize(100, 25)
  ChangeLogFrameMenu.closeButton:SetText(CLOSE)

  ChangeLogFrameMenu.closeButton:SetScript("OnClick", function()
    ChangeLogFrameMenu:Hide()
    LibStub("AceConfigDialog-3.0"):Open("MapNotes")
  end)

  ChangeLogFrameMenu:SetScript("OnHide", function()
    LibStub("AceConfigDialog-3.0"):Open("MapNotes")
  end)

  table.insert(UISpecialFrames, "MapNotesChangelogFrameMenu")
end

function ns.ShowChangelogWindowMenuOld()
  if (MapNotesChangelogFrame and MapNotesChangelogFrame:IsShown()) or (MapNotesChangelogFrameMenu and MapNotesChangelogFrameMenu:IsShown()) then return end

  local ChangeLogFrameMenu = CreateFrame("Frame", "MapNotesChangelogFrameMenu", UIParent, "BasicFrameTemplateWithInset")
  ChangeLogFrameMenu:SetSize(750, 400)
  ChangeLogFrameMenu:SetPoint("CENTER")
  ChangeLogFrameMenu:SetMovable(true)
  ChangeLogFrameMenu:EnableMouse(true)
  ChangeLogFrameMenu:RegisterForDrag("LeftButton")
  ChangeLogFrameMenu:SetScript("OnDragStart", ChangeLogFrameMenu.StartMoving)
  ChangeLogFrameMenu:SetScript("OnDragStop", ChangeLogFrameMenu.StopMovingOrSizing)
  ChangeLogFrameMenu:SetFrameStrata("DIALOG")
  ChangeLogFrameMenu:SetToplevel(true)
  ChangeLogFrameMenu:SetClampedToScreen(true)

  ChangeLogFrameMenu.title = ChangeLogFrameMenu:CreateFontString(nil, "OVERLAY", "GameFontHighlightLarge")
  ChangeLogFrameMenu.title:SetPoint("TOP", 0, -3)
  ChangeLogFrameMenu.title:SetText(ns.COLORED_ADDON_NAME .. "|cffffd700 " .. L["Changelog"])

  ChangeLogFrameMenu.fixedVersionText = ChangeLogFrameMenu:CreateFontString(nil, "OVERLAY", "GameFontHighlight")
  ChangeLogFrameMenu.fixedVersionText:SetPoint("TOPLEFT", 10, -5)
  ChangeLogFrameMenu.fixedVersionText:SetText("|cffffd700" .. GAME_VERSION_LABEL .. ":|r " .. "|cffff0000" .. ns.PreviousAddonVersion)

  ChangeLogFrameMenu.scrollFrame = CreateFrame("ScrollFrame", nil, ChangeLogFrameMenu, "UIPanelScrollFrameTemplate")
  ChangeLogFrameMenu.scrollFrame:SetPoint("TOPLEFT", 10, -40)
  ChangeLogFrameMenu.scrollFrame:SetPoint("BOTTOMRIGHT", -30, 50)

  local content = CreateFrame("Frame", nil, ChangeLogFrameMenu.scrollFrame) -- EditBox with padding inside frame
  content:SetSize(700, 1)
  ChangeLogFrameMenu.editBox = CreateFrame("EditBox", nil, content)
  ChangeLogFrameMenu.editBox:SetMultiLine(true)
  ChangeLogFrameMenu.editBox:SetFontObject(GameFontHighlight)

  local padding = 38 -- = 1cm left and right
  ChangeLogFrameMenu.editBox:SetWidth(700 - padding * 2)
  ChangeLogFrameMenu.editBox:SetPoint("TOPLEFT", padding, 0)
  ChangeLogFrameMenu.editBox:SetPoint("RIGHT", content, "RIGHT", -padding, 0)
  ChangeLogFrameMenu.editBox:SetAutoFocus(false)

  local changelogText = ns.LOCALE_CHANGELOG_OLD[GetLocale()] or ns.LOCALE_CHANGELOG_OLD["enUS"]
  ChangeLogFrameMenu.editBox:SetText("|cffffd700" .. changelogText)
  ChangeLogFrameMenu.scrollFrame:SetScrollChild(content)
  ChangeLogFrameMenu.closeButton = CreateFrame("Button", nil, ChangeLogFrameMenu, "GameMenuButtonTemplate")
  ChangeLogFrameMenu.closeButton:SetPoint("BOTTOMRIGHT", -10, -10)
  ChangeLogFrameMenu.closeButton:SetSize(100, 25)
  ChangeLogFrameMenu.closeButton:SetText(CLOSE)

  ChangeLogFrameMenu.closeButton:SetScript("OnClick", function()
    ChangeLogFrameMenu:Hide()
    LibStub("AceConfigDialog-3.0"):Open("MapNotes")
  end)

  ChangeLogFrameMenu:SetScript("OnHide", function()
    LibStub("AceConfigDialog-3.0"):Open("MapNotes")
  end)

  table.insert(UISpecialFrames, "MapNotesChangelogFrameMenu")
end

local DBFrame = CreateFrame("Frame")
DBFrame:RegisterEvent("ADDON_LOADED")
DBFrame:SetScript("OnEvent", function(_, event, addonName)
  if addonName == "HandyNotes_MapNotes" then
    if not HandyNotes_MapNotesRetailChangelogDB then
      HandyNotes_MapNotesRetailChangelogDB = {}
    end

    if not HandyNotes_MapNotesRetailChangelogDB.lastChangelogVersion then
      HandyNotes_MapNotesRetailChangelogDB.lastChangelogVersion = ns.PreviousAddonVersion
    end

    if HandyNotes_MapNotesRetailChangelogDB.lastChangelogVersion ~= ns.CurrentAddonVersion then
      ns.ShowChangelogWindow()
    end
  end
end)